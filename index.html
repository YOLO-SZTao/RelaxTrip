<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ…¢æ‚ æ¸¸</title>
    <style>
        body { background: #000; margin:0; padding:40px 0; display:flex; justify-content:center; align-items:center; min-height:100vh; font-family: "PingFang TC", sans-serif; }
        .iphone { width: 390px; height: 844px; background: #000; border-radius: 60px; box-shadow: 0 0 0 8px #111, 0 0 0 12px #222, inset 0 0 20px rgba(255,255,255,0.1); position: relative; overflow: hidden; }
        .screen { width: 100%; height: 100%; background: #f6f9fc; border-radius: 60px; overflow: hidden; position: relative; }
        .status-bar { height: 44px; background: rgba(255,255,255,0.95); display: flex; justify-content: space-between; align-items: center; padding: 0 30px; font-size: 17px; font-weight: 600; color: #000; }
        .notch { position: absolute; top: 8px; left: 50%; transform: translateX(-50%); width: 210px; height: 35px; background: #000; border-radius: 20px; }
        .app-content { height: calc(100% - 44px); overflow-y: auto; -webkit-overflow-scrolling: touch; position: relative; }
        .app { max-width:420px; margin:0 auto; background:#f6f9fc; height:100%; display:flex; flex-direction:column; position: relative; }
        .page { display:none; flex:1; overflow-y:auto; padding:20px; padding-bottom:140px; }
        .page.active { display:block; }
        .header { background:linear-gradient(135deg,#e0f2fe,#c8e6ff); padding:25px 20px; text-align:center; font-size:38px; color:#0277bd; font-weight:bold; }
        .card { background:white; border-radius:25px; padding:25px; margin-bottom:25px; box-shadow:0 8px 25px rgba(0,0,0,0.08); }
        .card-title { font-size:36px; color:#0277bd; margin:0 0 18px 0; }
        .card-text { font-size:30px; color:#333; line-height:1.8; margin:15px 0; }
        .big-btn { background:linear-gradient(135deg,#4fc3f7,#29b6f6); color:white; border:none; border-radius:30px; padding:20px; font-size:32px; font-weight:bold; margin:15px 0; width:100%; }
        .btn-row { display:flex; gap:12px; margin-top:15px; }
        .half-btn { flex:1; padding:18px; font-size:28px; border-radius:25px; text-align:center; }
        .detail-btn { background:#ffb74d; color:#333; }
        .enroll-btn { background:#81c784; color:white; }
        .reminder-item { background:linear-gradient(135deg,#fff59d,#ffeb3b); border-radius:20px; padding:18px; margin:12px 0; font-size:30px; display:flex; justify-content:space-between; align-items:center; overflow:hidden; min-height:70px; }
        .reminder-item .text { flex:1; padding-right:15px; word-break: break-word; }
        .reminder-item button { background:#81c784; color:white; border:none; padding:12px 24px; border-radius:20px; font-size:26px; white-space:nowrap; flex-shrink:0; margin-left:10px; }
        .confirmed .text { opacity:0.6; text-decoration:line-through; }
        .confirmed button { background:#81c784 !important; }
        .list-item { font-size:30px; margin:18px 0; padding:18px; background:#e8f5fe; border-radius:20px; cursor:pointer; }
        .trip-info { font-size:26px; color:#666; margin:8px 0; }
        .sub-nav { display:flex; justify-content:space-around; margin:20px 0; }
        .sub-nav-btn { background:#e0f2fe; color:#0277bd; border:none; padding:18px 10px; border-radius:30px; font-size:30px; font-weight:bold; flex:1; margin:0 8px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
        .sub-nav-btn.active { background:#0277bd; color:white; }
        .nav { position:absolute; bottom:20px; left:50%; transform:translateX(-50%); width:370px; background:white; border-radius:50px; display:flex; justify-content:space-around; padding:15px 0; box-shadow:0 10px 30px rgba(0,0,0,0.2); z-index:10; }
        .nav-item { text-align:center; font-size:24px; color:#aaa; cursor:pointer; }
        .nav-item.active { color:#4fc3f7; }
        .nav-icon { font-size:42px; display:block; }
        .form-input, select { width:100%; padding:18px; font-size:30px; margin:12px 0; border:2px solid #ccc; border-radius:20px; }
        .overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:99; }
        .modal { display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); width:320px; max-height:65vh; overflow-y:auto; background:white; border-radius:30px; padding:30px; box-shadow:0 20px 50px rgba(0,0,0,0.4); z-index:100; box-sizing:border-box; }
        .modal::-webkit-scrollbar { width:8px; }
        .modal::-webkit-scrollbar-thumb { background:#81c784; border-radius:4px; }
    </style>
</head>
<body>

<div class="iphone">
  <div class="screen">
    <div class="status-bar"><div>9:41</div><div>5Gã€€92%</div></div>
    <div class="notch"></div>
    
    <div class="app-content">
      <div class="app">

        <!-- 1. é¦–é  -->
        <div id="home" class="page active">
          <div class="header">æ…¢æ‚ æ¸¸</div>
          
          <div class="card">
            <div class="card-title">ä¸‹ä¸€è¡Œç¨‹</div>
            <div class="list-item" onclick="showDetail(trips[0])">
              å—è“®åœ’æ± ä¸€æ—¥éŠï¼ˆæ˜æ—¥ï¼‰
              <div class="trip-info">é›†åˆï¼šä¹é¾åŸå»£å ´ | 15äºº | å·²å ±åï¼šé™³ä¼¯æ¯ã€æä¼¯ä¼¯</div>
            </div>
          </div>

          <div class="card">
            <div class="card-title">å®‰å¿ƒå®ˆè­·</div>
            <div id="reminders">
              <div class="reminder-item" id="rem1">
                <div class="text">ä¸‹åˆ3:00 é™è¡€å£“è—¥</div>
                <button onclick="confirmMed(1)">å·²æœè—¥</button>
              </div>
              <div class="reminder-item" id="rem2">
                <div class="text">æ™šä¸Š8:00 ç¶­ç”Ÿç´ è£œå……</div>
                <button onclick="confirmMed(2)">å·²æœè—¥</button>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-title">ä»Šæ—¥ç‚ºä½ ç²¾é¸</div>
            <div id="home-recommend"></div>
          </div>
        </div>

        <!-- 2. è¡Œç¨‹é  -->
        <div id="trips" class="page">
          <div class="header">è¡Œç¨‹</div>
          <div class="sub-nav">
            <button class="sub-nav-btn active" onclick="showSubSection('my-trips')">æˆ‘çš„è¡Œç¨‹</button>
            <button class="sub-nav-btn" onclick="showSubSection('explore-trips')">è¡Œç¨‹æ¢ç´¢</button>
          </div>

          <div id="my-trips" class="sub-section active">
            <div class="card">
              <div class="card-title">æˆ‘çš„è¡Œç¨‹</div>
              <div id="my-trip-list">
                <div class="list-item" onclick="showDetail(trips[0])">
                  å—è“®åœ’æ± ä¸€æ—¥éŠ (æ˜æ—¥)
                  <div class="trip-info">é›†åˆï¼šä¹é¾åŸå»£å ´ | 15äºº</div>
                </div>
              </div>
            </div>
          </div>

          <div id="explore-trips" class="sub-section" style="display:none;">
            <div class="card">
              <div class="card-title">æ‰€æœ‰è¡Œç¨‹</div>
              <div id="all-trips">
                <!-- è¡Œç¨‹åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
              </div>
            </div>
          </div>
        </div>

        <!-- 3. æœ‹å‹é ï¼ˆæ¯æ¬¡é»æ“Šéƒ½åˆ·æ–°æ–°äººï¼‰ -->
        <div id="friends" class="page">
          <div class="header">æœ‹å‹</div>
          <div class="sub-nav">
            <button class="sub-nav-btn active" onclick="showSubSection('old-friends')">è€å‹è¨˜</button>
            <button class="sub-nav-btn" onclick="showSubSection('new-friends')">æ–°æœ‹å‹</button>
          </div>
          <div id="old-friends" class="sub-section active">
            <div class="card">
              <div class="card-title">è€å‹è¨˜</div>
              <div id="friend-list">
                <div class="list-item">é™³ä¼¯æ¯ï¼ˆæ­¥ä¼æ…¢ | ä½é ç®— | æ–‡åŒ–å‹ï¼‰</div>
                <div class="list-item">æä¼¯ä¼¯ï¼ˆä¸­ç­‰æ­¥ä¼ | ä¸­é ç®— | è‡ªç„¶å‹ï¼‰</div>
              </div>
            </div>
          </div>
          <div id="new-friends" class="sub-section" style="display:none;">
            <div class="card">
              <div class="card-title">æ™ºèƒ½æ—…ä¼´é…å°</div>
              <div class="card-text">æ ¹æ“šä½ çš„é«”åŠ›ã€ç¯€å¥ã€é ç®—è‡ªå‹•é…å°</div>
              <button class="big-btn" onclick="smartMatch()">é–‹å§‹é…å°</button>
              <div id="match-result" class="card-text" style="display:none;margin-top:20px;"></div>
            </div>
          </div>
        </div>

        <!-- 4. æˆ‘çš„é  -->
        <div id="my" class="page">
          <div class="header">æˆ‘çš„</div>
          <div class="card">
            <div class="card-title">å€‹äººæ—…éŠåå¥½</div>
            <select class="form-input" id="physical">
              <option>é«”åŠ›å……æ²›ï¼ˆå¯æ­¥è¡Œ5km+ï¼‰</option>
              <option selected>ä¸€èˆ¬ï¼ˆ3-5kmï¼‰</option>
              <option>è¼ƒå¼±ï¼ˆéœ€è¼”åŠ©ï¼‰</option>
            </select>
            <select class="form-input" id="rhythm">
              <option>è¶…æ…¢éŠï¼ˆæ¯å¤©<2kmï¼‰</option>
              <option selected>æ…¢éŠï¼ˆ<3kmï¼‰</option>
              <option>æ­£å¸¸ç¯€å¥</option>
            </select>
            <button class="big-btn" onclick="saveProfile()">ä¿å­˜åå¥½</button>
          </div>
          <div class="card" id="my-trips-card" onclick="showMyTrips()">
            <div class="card-title">æˆ‘çš„è¡Œç¨‹</div>
            <div id="my-trip-list2"></div>
          </div>
        </div>

        <!-- åº•éƒ¨å°èˆª -->
        <div class="nav">
          <div class="nav-item active" onclick="switchPage('home')"><span class="nav-icon">ğŸ </span>é¦–é </div>
          <div class="nav-item" onclick="switchPage('trips')"><span class="nav-icon">ğŸ—“ï¸</span>è¡Œç¨‹</div>
          <div class="nav-item" onclick="switchPage('friends')"><span class="nav-icon">ğŸ‘¥</span>æœ‹å‹</div>
          <div class="nav-item" onclick="switchPage('my')"><span class="nav-icon">ğŸ‘¤</span>æˆ‘çš„</div>
        </div>

      </div>
    </div>
  </div>
</div>

<!-- å½ˆçª— -->
<div class="overlay" id="overlay" onclick="closeDetail()"></div>
<div class="modal" id="modal">
  <div class="card-title" id="modal-title" style="font-size:34px;"></div>
  <div class="card-text" id="modal-content" style="font-size:28px;line-height:1.9;"></div>
  <button class="big-btn" onclick="closeDetail()">é—œé–‰</button>
</div>

<script>

// æ‰€æœ‰è¡Œç¨‹æ•°æ®
const trips = [
  {name:"å—è“®åœ’æ± ä¸€æ—¥éŠ", time:"æ˜æ—¥ 09:30-16:30", location:"ä¹é¾åŸå»£å ´å·´å£«ç«™", people:"15äºº", friends:"é™³ä¼¯æ¯ã€æä¼¯ä¼¯", highlight:"è³èŠ±+å¤ªæ¥µ+ç´ é£Ÿåˆé¤+ç„¡éšœç¤™é€šé“", suitable:"æ…¢æ­¥+æ–‡åŒ–æ„›å¥½è€…"},
  {name:"ç¶­å¤šåˆ©äºæ¸¯å¤œéŠ", time:"æ¯é€±äº” 19:00-21:30", location:"å°–æ²™å’€é˜æ¨“æ—", people:"15äºº", friends:"é™³ä¼¯æ¯", highlight:"å¹»å½©è© é¦™æ±Ÿ+éŠèˆ¹+å¤œæ™¯æ”å½±", suitable:"æ”å½±æ„›å¥½è€…"},
  {name:"å¤ªå¹³å±±é ‚æ…¢æ­¥ä¹‹æ—…", time:"æ¯é€±ä¸‰ 10:00-15:00", location:"ä¸­ç’°åœ°éµAå‡ºå£", people:"12äºº", friends:"ç„¡", highlight:"çºœè»Šä¸Šå±±+ç’°å±±ç·©æ­¥+å…¨æ™¯è§€æ™¯å°", suitable:"å–œæ­¡é¢¨æ™¯äººå£«"},
  {name:"å¤§å¶¼å±±ç”Ÿæ…‹æ…¢éŠ", time:"12æœˆ3æ—¥ 09:00-15:00", location:"æ±æ¶ŒBå‡ºå£", people:"20äºº", friends:"æä¼¯ä¼¯", highlight:"å¤©å£‡å¤§ä½›+æ˜‚åªå¸‚é›†", suitable:"è‡ªç„¶æ„›å¥½è€…"},
  {name:"ä¹é¾åŸæ‡·èˆŠä¹‹æ—…", time:"12æœˆ10æ—¥ 10:00-14:00", location:"ä¹é¾åŸå»£å ´", people:"10äºº", friends:"ç„¡", highlight:"å•Ÿå¾·èˆŠæ©Ÿå ´+ä¹é¾åŸå¯¨å…¬åœ’", suitable:"æ‡·èˆŠäººå£«"},
  {name:"é¦™æ¸¯åšç‰©é¤¨æ—¥", time:"12æœˆ17æ—¥ 10:30-16:00", location:"å°–æ²™å’€æ–‡åŒ–ä¸­å¿ƒ", people:"18äºº", friends:"ç„¡", highlight:"æ­·å²+ç§‘å­¸åšç‰©é¤¨", suitable:"çŸ¥è­˜å‹é•·è€…"},
  // å†å²è¡Œç¨‹ç¤ºä¾‹
  {name:"æ·±åœ³ç£å…¬åœ’æ…¢éŠ", time:"11æœˆ15æ—¥ 09:00-15:00", location:"æ·±åœ³ç£å…¬åœ’å…¥å£", people:"12äºº", friends:"é™³ä¼¯æ¯ã€æä¼¯ä¼¯", highlight:"æµ·æ¿±æ­¥é“æ¼«æ­¥+ç´…æ¨¹æ—ç”Ÿæ…‹æ¬£è³+é‡é¤æ´»å‹•", suitable:"è‡ªç„¶æ„›å¥½è€…"}
];

// å·²æŠ¥åçš„æœªæ¥è¡Œç¨‹
let enrolledTrips = ["å—è“®åœ’æ± ä¸€æ—¥éŠ"];

// å†å²è¡Œç¨‹ï¼ˆç”¨æˆ·è¿‡å»å‚åŠ è¿‡çš„è¡Œç¨‹ï¼‰
let historicalTrips = ["æ·±åœ³ç£å…¬åœ’æ…¢éŠ"];

function updateAllTrips() {
  // è·å–æœªæ¥è¡Œç¨‹ï¼ˆå·²æŠ¥åçš„è¡Œç¨‹ï¼‰
  const futureTripsHtml = enrolledTrips.map((t, i) => {
    // æ ¹æ®è¡Œç¨‹åç§°ç²¾ç¡®æŸ¥æ‰¾å¯¹åº”çš„è¡Œç¨‹å¯¹è±¡
    const tripObj = trips.find(tr => tr.name === t) || trips[0];
    // æ˜¾ç¤ºå®Œæ•´çš„è¡Œç¨‹ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ—¶é—´
    const displayText = `${t} (${tripObj.time.split(' ')[0]})`;
    // é€šè¿‡ç´¢å¼•å¼•ç”¨è¡Œç¨‹å¯¹è±¡ï¼Œé¿å…ä½œç”¨åŸŸé—®é¢˜
    const tripIndex = trips.indexOf(tripObj);
    return `<div class="list-item" onclick="showTripDetail(trips[${tripIndex}])">
      ${displayText}
      <div class="trip-info">é›†åˆï¼š${tripObj.location} | ${tripObj.people}</div>
    </div>`;
  }).join('');
  
  // è·å–å†å²è¡Œç¨‹
  const pastTripsHtml = historicalTrips.map((t, i) => {
    // æ ¹æ®è¡Œç¨‹åç§°ç²¾ç¡®æŸ¥æ‰¾å¯¹åº”çš„è¡Œç¨‹å¯¹è±¡
    const tripObj = trips.find(tr => tr.name === t) || trips[0];
    // é€šè¿‡ç´¢å¼•å¼•ç”¨è¡Œç¨‹å¯¹è±¡ï¼Œé¿å…ä½œç”¨åŸŸé—®é¢˜
    const tripIndex = trips.indexOf(tripObj);
    return `<div class="list-item" onclick="showTripDetail(trips[${tripIndex}])">
      ${t} (æ­·å²è¡Œç¨‹)
      <div class="trip-info">æ™‚é–“ï¼š${tripObj.time.split(' ')[0]} | åƒèˆ‡äººæ•¸ï¼š${tripObj.people}</div>
    </div>`;
  }).join('');
  
  // ç»„åˆæœªæ¥è¡Œç¨‹å’Œå†å²è¡Œç¨‹
  const html = futureTripsHtml + (pastTripsHtml ? `<div style="margin-top: 20px;"><strong>æ­·å²è¡Œç¨‹</strong></div>${pastTripsHtml}` : '');
  
  document.getElementById('my-trip-list').innerHTML = html;
  document.getElementById('my-trip-list2').innerHTML = html;
}

function updateExploreTrips() {
  const html = trips.map((trip, index) => {
    // åˆ¤æ–­æ˜¯å¦ä¸ºå†å²è¡Œç¨‹
    const isHistorical = !isFutureTrip(trip.time);
    
    if (isHistorical) {
      // å†å²è¡Œç¨‹æ˜¾ç¤ºä¸åŒçš„UI
      return `<div class="list-item">
        ${trip.name} (æ­·å²è¡Œç¨‹)
        <div class="trip-info">æ™‚é–“ï¼š${trip.time.split(' ')[0]} | åƒèˆ‡äººæ•¸ï¼š${trip.people}</div>
        <div class="btn-row">
          <button class="half-btn detail-btn" onclick="event.stopPropagation(); showTripDetail(trips[${index}])">æŸ¥çœ‹å›æ†¶</button>
        </div>
      </div>`;
    } else {
      // æœªæ¥è¡Œç¨‹ä¿æŒåŸæœ‰UI
      const timeInfo = trip.time.includes("æ¯é€±") ? trip.time : trip.time.split(' ')[0];
      const enrolledFriends = trip.friends !== "ç„¡" ? `å·²å ±åï¼š${trip.friends}` : "";
      return `<div class="list-item">
        ${trip.name} Â· ${timeInfo}
        <div class="trip-info">é›†åˆï¼š${trip.location} | é æœŸ${trip.people}${enrolledFriends ? ` | ${enrolledFriends}` : ""}</div>
        <div class="btn-row">
          <button class="half-btn detail-btn" onclick="event.stopPropagation(); showDetail(trips[${index}])">æŸ¥çœ‹è©³æƒ…</button>
          <button class="half-btn enroll-btn" onclick="event.stopPropagation(); enrollTrip(trips[${index}])">å ±ååƒåŠ </button>
        </div>
      </div>`;
    }
  }).join('');
  
  document.getElementById('all-trips').innerHTML = html;
}

function updateHomeRecommend() {
  const available = trips.slice(1).filter(t => !enrolledTrips.some(e => e === t.name));
  const best = available[0] || null;
  if (best) {
    document.getElementById('home-recommend').innerHTML = `
      <div class="list-item" onclick="showDetail(trips[${trips.indexOf(best)}])">
        ${best.name}
        <div class="trip-info">é›†åˆï¼š${best.location} | ${best.people} | å·²å ±åï¼š${best.friends}</div>
        <div class="btn-row">
          <button class="half-btn detail-btn" onclick="event.stopPropagation(); showDetail(trips[${trips.indexOf(best)}])">æŸ¥çœ‹è©³æƒ…</button>
          <button class="half-btn enroll-btn" onclick="event.stopPropagation(); enrollTrip(trips[${trips.indexOf(best)}])">å ±ååƒåŠ </button>
        </div>
      </div>`;
  } else {
    document.getElementById('home-recommend').innerHTML = '<div class="card-text">å·²ç‚ºä½ ç²¾é¸å®Œæ‰€æœ‰åˆé©è¡Œç¨‹ï½</div>';
  }
}

function enrollTrip(trip) {
  if (confirm(`ç¢ºå®šå ±åã€Œ${trip.name}ã€å—ï¼Ÿ`)) {
    // ä½¿ç”¨ç»Ÿä¸€çš„æ ¼å¼æ·»åŠ åˆ°å·²æŠ¥åè¡Œç¨‹åˆ—è¡¨
    enrolledTrips.push(`${trip.name}`);
    updateAllTrips();
    updateHomeRecommend();
    alert('å ±åæˆåŠŸï¼å·²åŠ å…¥æˆ‘çš„è¡Œç¨‹');
  }
}

function showDetail(trip) {
  if (event) event.stopPropagation();
  document.getElementById('modal-title').innerText = trip.name;
  document.getElementById('modal-content').innerHTML = `
    æ™‚é–“ï¼š${trip.time}<br>
    é›†åˆåœ°é»ï¼š${trip.location}<br>
    é æœŸäººæ•¸ï¼š${trip.people}<br>
    å·²å ±åè€å‹ï¼š${trip.friends}<br><br>
    è¡Œç¨‹äº®é»ï¼š${trip.highlight}<br>
    é©åˆäººç¾¤ï¼š${trip.suitable}<br><br>
    å…¨ç¨‹ç„¡éšœç¤™ã€å°ˆè»Šæ¥é€ã€æ­¥è¡Œå°‘æ–¼3å…¬é‡Œï¼Œå®‰å¿ƒå‡ºéŠï¼
  `;
  document.getElementById('overlay').style.display = 'block';
  document.getElementById('modal').style.display = 'block';
}

function closeDetail() {
  document.getElementById('overlay').style.display = 'none';
  document.getElementById('modal').style.display = 'none';
}

function confirmMed(id) {
  const item = document.getElementById('rem'+id);
  item.classList.add('confirmed');
  item.querySelector('button').textContent = 'å·²ç¢ºèª';
  item.querySelector('button').disabled = true;
  alert('å·²ç¢ºèªæœè—¥');
}

// æ¯æ¬¡é»ã€Œé–‹å§‹é…å°ã€éƒ½æœƒåˆ·æ–°æ–°äºº
function smartMatch() {
  const candidates = [
    "å¼µä¼¯ä¼¯ï¼ˆæ­¥ä¼æ…¢ | ä½é ç®— | æ–‡åŒ–å‹ï¼‰",
    "ç‹å©†å©†ï¼ˆè¶…æ…¢éŠ | ä½é ç®— | è‡ªç„¶å‹ï¼‰",
    "åŠ‰ä¼¯æ¯ï¼ˆä¸€èˆ¬é«”åŠ› | ä¸­é ç®— | æ”å½±æ„›å¥½ï¼‰",
    "é™³ä¼¯ä¼¯ï¼ˆé«”åŠ›å……æ²› | ä¸­é ç®— | ç¾é£Ÿå‹ï¼‰",
    "ä½•å©†å©†ï¼ˆè¼ƒå¼±é«”åŠ› | ä½é ç®— | å®—æ•™å‹ï¼‰"
  ];
  const random = candidates[Math.floor(Math.random() * candidates.length)];
  document.getElementById('match-result').innerHTML = `
    æ¨è–¦æ—…ä¼´ï¼š${random}<br>
    <button class="big-btn" style="margin-top:20px;" onclick="addFriend('${random}'); this.disabled=true;">æ·»åŠ ç‚ºè€å‹</button>
  `;
  document.getElementById('match-result').style.display = 'block';
}

function addFriend(name) {
  document.getElementById('friend-list').innerHTML += `<div class="list-item">${name}</div>`;
  alert('å·²æˆåŠŸæ·»åŠ è€å‹ï¼');
}

function saveProfile() {
  alert('å€‹äººåå¥½å·²æ›´æ–°ï¼');
}

function showMyTrips() {
  // è·³è½¬åˆ°è¡Œç¨‹é¡µé¢çš„"æˆ‘çš„è¡Œç¨‹"æ ‡ç­¾
  switchPage('trips');
  showSubSection('my-trips');
}

// åˆ¤æ–­è¡Œç¨‹æ˜¯å†å²è¡Œç¨‹è¿˜æ˜¯æœªæ¥è¡Œç¨‹
function isFutureTrip(tripTime) {
  // ç®€å•åˆ¤æ–­ï¼šå¦‚æœåŒ…å«"æ˜æ—¥"æˆ–"æ¯é€±"ï¼Œåˆ™ä¸ºæœªæ¥è¡Œç¨‹
  // å¦‚æœåŒ…å«å…·ä½“æ—¥æœŸä¸”ä¸æ˜¯è¿‡å»çš„æ—¥æœŸï¼Œåˆ™ä¸ºæœªæ¥è¡Œç¨‹
  // å¯¹äºå†å²è¡Œç¨‹ï¼Œæˆ‘ä»¬å‡è®¾å®ƒä»¬ä¸ä¼šåŒ…å«"æ˜æ—¥"æˆ–"æ¯é€±"ï¼Œå¹¶ä¸”å¦‚æœæ˜¯è¿‡å»çš„æ—¥æœŸä¹Ÿä¸ä¼šæ˜¾ç¤ºæŠ¥åæŒ‰é’®
  return tripTime.includes("æ˜æ—¥") || tripTime.includes("æ¯é€±");
}

// æ˜¾ç¤ºè¡Œç¨‹è¯¦æƒ…ï¼ˆæ ¹æ®å†å²æˆ–æœªæ¥è¡Œç¨‹æ˜¾ç¤ºä¸åŒå†…å®¹ï¼‰
function showTripDetail(trip) {
  if (event) event.stopPropagation();
  
  // åˆ¤æ–­æ˜¯å¦ä¸ºæœªæ¥è¡Œç¨‹
  const isFuture = isFutureTrip(trip.time);
  
  // æ£€æŸ¥è¡Œç¨‹æ˜¯å¦å·²æŠ¥å
  const isEnrolled = enrolledTrips.includes(trip.name);
  
  document.getElementById('modal-title').innerText = trip.name;
  
  if (isFuture) {
    // æœªæ¥è¡Œç¨‹æ˜¾ç¤ºåŸºç¡€ä¿¡æ¯
    document.getElementById('modal-content').innerHTML = `
      æ™‚é–“ï¼š${trip.time}<br>
      é›†åˆåœ°é»ï¼š${trip.location}<br>
      é æœŸäººæ•¸ï¼š${trip.people}<br>
      å·²å ±åè€å‹ï¼š${trip.friends}<br><br>
      è¡Œç¨‹äº®é»ï¼š${trip.highlight}<br>
      é©åˆäººç¾¤ï¼š${trip.suitable}<br><br>
      å…¨ç¨‹ç„¡éšœç¤™ã€å°ˆè»Šæ¥é€ã€æ­¥è¡Œå°‘æ–¼3å…¬é‡Œï¼Œå®‰å¿ƒå‡ºéŠï¼
      <br><br>
      ${isEnrolled ? 
        `<button class="big-btn" style="background:#ff8a65;" onclick="unenrollTrip('${trip.name}')">ç”³è«‹é€€å‡º</button>` : 
        `<button class="big-btn" onclick="enrollTripFromDetail('${trip.name}')">å ±ååƒåŠ </button>`}
    `;
  } else {
    // å†å²è¡Œç¨‹æ˜¾ç¤ºå›å¿†åŠŸèƒ½
    document.getElementById('modal-content').innerHTML = `
      æ™‚é–“ï¼š${trip.time}<br>
      é›†åˆåœ°é»ï¼š${trip.location}<br>
      åƒèˆ‡äººæ•¸ï¼š${trip.people}<br>
      åŒè¡Œè€å‹ï¼š${trip.friends}<br><br>
      è¡Œç¨‹äº®é»å›é¡§ï¼š${trip.highlight}<br><br>
      <div style="text-align:center; margin:20px 0;">
        <div style="background:#e0f2fe; border-radius:15px; padding:15px; margin-bottom:15px;">
          <h3 style="margin:0 0 10px 0; color:#0277bd;">è¡Œç¨‹å›æ†¶</h3>
          <p style="margin:0;">é€™è£¡å¯ä»¥é¡¯ç¤ºç…§ç‰‡ã€éŠè¨˜ç­‰å›æ†¶å…§å®¹</p>
        </div>
        <button class="big-btn" style="background:#ffb74d;" onclick="shareMemory()">åˆ†äº«å›æ†¶</button>
      </div>
    `;
  }
  
  document.getElementById('overlay').style.display = 'block';
  document.getElementById('modal').style.display = 'block';
}

// ä»è¯¦æƒ…é¡µé¢æŠ¥åå‚åŠ è¡Œç¨‹
function enrollTripFromDetail(tripName) {
  const trip = trips.find(t => t.name === tripName);
  if (trip && confirm(`ç¢ºå®šå ±åã€Œ${trip.name}ã€å—ï¼Ÿ`)) {
    enrolledTrips.push(`${trip.name}`);
    updateAllTrips();
    updateHomeRecommend();
    alert('å ±åæˆåŠŸï¼å·²åŠ å…¥æˆ‘çš„è¡Œç¨‹');
    closeDetail();
  }
}

// ä»è¯¦æƒ…é¡µé¢å–æ¶ˆæŠ¥å
function unenrollTrip(tripName) {
  if (confirm(`ç¢ºå®šè¦é€€å‡ºã€Œ${tripName}ã€å—ï¼Ÿ`)) {
    // ä»å·²æŠ¥ååˆ—è¡¨ä¸­ç§»é™¤
    enrolledTrips = enrolledTrips.filter(name => name !== tripName);
    updateAllTrips();
    updateHomeRecommend();
    alert('å·²æˆåŠŸé€€å‡ºè©²è¡Œç¨‹');
    closeDetail();
  }
}

// åˆ†äº«å›å¿†åŠŸèƒ½
function shareMemory() {
  alert('æ„Ÿè¬åˆ†äº«æ‚¨çš„ç¾å¥½å›æ†¶ï¼');
  closeDetail();
}

function switchPage(id) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  event.target.closest('.nav-item').classList.add('active');
}

function showSubSection(id) {
  document.querySelectorAll('.sub-section').forEach(s => s.style.display = 'none');
  document.getElementById(id).style.display = 'block';
  document.querySelectorAll('.sub-nav-btn').forEach(b => b.classList.remove('active'));
  event.target.classList.add('active');
  
  // å½“åˆ‡æ¢åˆ°"æ‰€æœ‰è¡Œç¨‹"æ ‡ç­¾æ—¶ï¼Œæ›´æ–°è¡Œç¨‹åˆ—è¡¨
  if (id === 'explore-trips') {
    updateExploreTrips();
  }
}

window.onload = function() {
  updateAllTrips();
  updateHomeRecommend();
  updateExploreTrips();
};

setTimeout(() => {
  if (document.getElementById('home').classList.contains('active')) {
    alert("ç‹ä¼¯ä¼¯ï¼Œæ­¡è¿å›ä¾†ï¼è¨˜å¾—æŸ¥çœ‹å®‰å¿ƒå®ˆè­·åŒä»Šæ—¥ç²¾é¸å‘€ï½");
  }
}, 8000);
</script>
</body>
</html>